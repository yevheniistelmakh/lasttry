
pipeline {
    agent {
        docker { 
          image 'yevhenii1991/jenkins-slave-dind:latest' 
        }
    }
    environment {
      DOCKERHUB_CREDENTIALS = credentials('jemkins-dockerhub')
    }
    stages {
    stage('Build') {
         steps { 
           sh 'docker ps -a'
	   sh 'docker images'
}
	 }
    stage('Delete workspace before build starts') {
            steps {
                echo 'Deleting workspace'
                deleteDir()
            }
        }
    stage('1234') {
         steps { 
	   sh 'git clone https://github.com/yevheniistelmakh/lasttry.git'
	   sh 'pwd'
	   sh 'ls -al'
	   sh 'docker build -t yevhenii1991/wordpress /var/jenkins_home/workspace/pip1/lasttry/uno/'
		}
	     }
	      stage('login') {
         steps { 
	   sh 'docker logout'
	   sh 'echo $DOCKERHUB_CREDENTIALS_PSW |  docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
	   sh ''
		}
	     }
	     stage('Push') {
	    steps {
		sh 'docker push yevhenii1991/wordpress:latest'
		}
         }
  }
}
