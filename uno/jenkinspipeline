pipeline {
    agent {
        docker { image 'benhall/dind-jenkins-agent:latest' }
    }
    environment {
      DOCKERHUB_CREDENTIALS = credentials('jemkins-dockerhub')
    }
    stages {
        stage('Test') {
            steps {
                sh 'node --version'
            }
        }
         stage('Build') {
            steps { 
	         sh 'docker build -t yevhenii1991/wordpress'
		}
	   
	 }
	  stage('login') {
             steps {
		  sh 'echo $DOCKERHUB_CREDENTIALS_PSW |  docker login -u $DOCKERHUB_CREDENTIALS_USR --password-stdin'
    		  }
		}
	  stage('Push') {
	    steps {
		sh 'docker push yevhenii1991/wordpress:latest'
		}
	      }
    }
}
